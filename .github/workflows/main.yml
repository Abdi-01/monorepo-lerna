name : CD monorepo-v1.0

on : 
  push :
    branches :
      - main
      
jobs :
  cd:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v2
      
      - name: Deploy Lerna-API with github action
        uses: appleboy/ssh-action@master
        with:
          host: ${{secrets.SSH_HOST}}
          username: ${{secrets.SSH_USER}}
          key: ${{secrets.SSH_KEY}}
          port: 22
          script: |
            cd monorepo-lerna
            git add .
            git commit -m "LN-00-server : server commit modified file"
            git pull origin development
            lerna bootstrap --hoist
            cd ./packages/api-express/
            pm2 start index.js --name lerna-api
      # Runs a set of commands using the runners shell
      - name: Run a multi-line script
        run: |
          echo Add other actions to build,
          echo test, and deploy your project.
